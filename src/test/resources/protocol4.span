# Example Protocol

.metadata

    version : 1.0;
    recipe size : 1;

.constants

    fraction p : 1/2;

.signature

    variables : m, r, k, u, v, f0, f1;
    functions : enc/2, dec/2, h/1;
    public names : a, b, c;
    private names : x, y, z;

.rewrites

    rewrite : dec(enc(m,k), k) -> m;

.roles

    role : in(f0). [ f0 = c ] out (1 -> h(a)) . in(f1) . [T] out(1 -> dec(f1, z));
    role : [T] out(p -> enc(x , z) + p -> x);

.safety
    secrecy : x >= 1/2;