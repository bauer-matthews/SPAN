# Example Protocol

.metadata

    version : 1.0;

.constants

    fraction p : 1/2;

.signature

    variables : m, r, k, u, v;
    functions : enc/3, dec/2, h/1;
    public names : a, b, c;
    private names : x, y, z;

.rewrites

    rewrite : dec(enc(m,r,k), k) -> m;

.roles

    role : in(u) . [u = v, v = h(v)] out(1 -> enc(u,a,b));
    role : in(v) . [u = v, T] out(p -> h(u) | h(v) + p -> h(v));

.safety
    secrecy : m;